# 部署与更新指南

> **说明**：记录如何将项目部署到网上，以及如何更新

---

## 一、项目地址

| 项目 | 地址 |
|------|------|
| GitHub 仓库 | https://github.com/zhoul-666/gongzhi |
| Streamlit 网站 | （部署后填写，格式如 xxx.streamlit.app） |

---

## 二、首次部署（已完成）

### 1. GitHub 仓库设置
- 已创建仓库：`zhoul-666/gongzhi`
- 已配置 SSH 密钥，可以直接推送

### 2. Streamlit Cloud 部署步骤
1. 打开 https://share.streamlit.io
2. 用 GitHub 账号登录
3. 点击 **New app**
4. 选择：
   - **Repository**: `zhoul-666/gongzhi`
   - **Branch**: `main`
   - **Main file path**: `app/main.py`
5. 点击 **Advanced settings**，在 **Secrets** 里填入：
   ```
   password = "123456"
   ```
6. 点击 **Deploy**

---

## 三、日常更新流程

### 对 Claude 说：
> "上传" 或 "推送到 GitHub"

### Claude 会执行：
```bash
git add .
git commit -m "修改说明"
git push
```

### 然后：
- Streamlit Cloud 会**自动检测**代码变化
- 大约 **1-2 分钟**后网站自动更新
- 不需要手动操作

---

## 四、密码管理

### 本地密码文件
- 位置：`.streamlit/secrets.toml`
- 内容：`password = "123456"`
- **注意**：此文件不会上传到 GitHub（已在 .gitignore 中忽略）

### Streamlit Cloud 密码配置
在 Streamlit Cloud 后台 → Settings → Secrets 中填入：
```
require_password = true
password = "123456"
```

**重要**：线上必须设置 `require_password = true`，否则不会要求密码！

### 本地 vs 线上
| 环境 | require_password | 效果 |
|------|-----------------|------|
| 本地 | false | 不需要密码，直接进入 |
| 线上 | true | 需要输入密码才能进入 |

### 修改密码
1. 修改 Streamlit Cloud 后台的 Secrets 中的 `password` 值
2. 本地的密码配置不影响线上

---

## 五、常见问题

### Q: 推送失败怎么办？
检查网络连接，或者重新运行：
```bash
git push
```

### Q: 网站没有自动更新？
1. 等待 2-3 分钟
2. 如果还没更新，去 Streamlit Cloud 后台手动点击 "Reboot app"

### Q: 忘记密码了？
查看本地文件：`.streamlit/secrets.toml`

---

## 六、SSH 密钥信息（备份）

已配置的 SSH 密钥：
- 私钥位置：`~/.ssh/id_ed25519`（绝对不能泄露！）
- 公钥位置：`~/.ssh/id_ed25519.pub`
- 已添加到 GitHub：https://github.com/settings/keys

---

*文档创建时间：2024年12月30日*
