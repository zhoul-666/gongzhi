# 绩效核算系统 - 1228执行前的沟通

> 本文件基于1226工作进度沟通.md，补充了1228沟通确认的细节

---

## 一、ERP绩效数据格式（已确认）

**文件**：`11月生产绩效统计-20251228125456.xls`（实际是HTML格式）

**关键列**：
| 列名 | 用途 |
|-----|------|
| 生产人员 | 员工姓名，首次导入自动创建员工 |
| 印前处理分值 | 印前大区域的绩效分 |
| 印中制作分值 | 印中大区域的绩效分 |
| 印后加工分值 | 印后大区域的绩效分 |

**其他列**：订单数、绩效金额等暂不使用

**特殊账户**："微店公用账户"需要保留，用于存放无法归属的绩效

---

## 二、三种模式的小技能表（已确认）

**文件**：`技能.xlsx`

### 1. 门店模式
- **位置**：Excel第9-10行
- **大区域**：印前、印中、印后、前台
- **印前**：文本标准化、基础CAD标准化、高级CAD标准化、初级仿制
- **印中**：操机打印、设备维护
- **印后**：图纸处理、简装精装、特殊工艺
- **前台**：接待票据、图纸商务业务、印刷业务、广告业务、管理调配、送货推广

### 2. 中央工厂模式
- **位置**：Excel第16-17行
- **大区域**：印前、印中、印后、材料熟悉、前台接待、前台报价、前台业务洽谈、供应链、送货
- **印前**：CAD导pdf、拼板、特殊装订文本、刀板、初级仿制
- **印中**：文本、图纸、设备维护
- **印后**：图纸处理、软装、裁切、硬装、设备简单处理
- **其他**：纸张、工艺材料、常用包装材料、网络/现场接单、收银结算开票等

### 3. 喷印工厂模式
- **位置**：Excel第38-40行
- **大区域**：印前、印中（写真类/平板）、印后、机器维护、前台、岗位管理
- **印前**：cdr/pdf导图、AI导图、文件拼版及生成刀版、cdr简单排版
- **印中-写真类**：发图、常规打印
- **印中-平板**：覆膜、裱板、雕刻、木工拼版雕刻、激光拼版雕刻
- **印后**：后期粘接、广告物料个性美陈组合、全品类个性方案
- **机器维护**：写真/平板/木工/激光机器维护保养维修
- **前台**：接单、票据整理、广告物料报价、数码印刷物料接单、广告门头/定制类标识报价

---

## 三、技能工资计算逻辑（已确认）

### 计算流程
```
员工某项小技能的工资计算：
├── 第一步：是否通过考核？（管理员手动设置）
│   ├── 未通过考核 → 没有这项技能工资（0元）
│   └── 通过考核 → 进入第二步
│
└── 第二步：是否在岗？（按大区域绩效自动判断）
    ├── 该技能所属大区域的绩效 ≥ 达标值 → 在岗工资
    └── 该技能所属大区域的绩效 < 达标值 → 不在岗工资
```

### 关键规则
- **考核**：管理员手动标记通过/不通过，线下三个月复核一次
- **在岗判断**：按大区域整体判断，不是按单个技能
  - 例：员工印前绩效5万 ≥ 达标值3万 → 他所有印前小技能都算"在岗"
- **模式限制**：一个员工只属于一种模式（门店/中央工厂/喷印工厂）

### 工资设置
- **在岗工资**：每个小技能独立设置（默认200元）
- **不在岗工资**：每个小技能独立设置（默认100元）
- 管理员需要能批量修改工资设置（业务变化时调整）

---

## 四、大区域与阶梯规则（已确认）

### 大区域
- **目前**：印前、印中、印后、前台
- **以后可能新增**：供应链、送货等
- 管理员可增删大区域

### 阶梯规则
- 每个大区域有独立的阶梯规则
- 约7个级别（如：0-3万、3-5万、5-10万、10-20万、20-30万、30-40万、40万以上）
- 每个级别对应不同的奖金金额
- 管理员可自由配置：区间起点、区间终点、区间奖金

### 达标值
- 管理员可配置每个大区域的达标值
- 默认约3万（用于判断在岗/不在岗）

---

## 五、员工管理（已确认）

### 自动创建
- 导入绩效时，如果员工姓名不存在，自动创建
- 后续导入时，相同姓名匹配现有员工，新姓名自动新增

### 双编号机制
- **系统ID**：自动生成，永不改变，用于历史追溯
- **工号**：管理员可修改的显示编号

### 模式归属
- 每个员工必须指定所属模式（门店/中央工厂/喷印工厂）
- 模式决定可选的小技能列表

---

## 六、小技能管理界面设计

### 数据结构
```
小技能
├── 技能名称
├── 所属模式（门店/中央工厂/喷印工厂）
├── 所属大区域（印前/印中/印后/前台/...）
├── 在岗工资（默认200）
└── 不在岗工资（默认100）
```

### 管理界面
- 表格式批量编辑
- 支持按模式、大区域筛选
- 支持勾选多个后批量修改工资
- 支持单个直接编辑

---

## 七、待开发功能清单

### 第一阶段：基础数据管理
1. 项目目录结构
2. 数据存储（JSON格式）
3. 员工管理页面
4. 大区域管理页面（含阶梯规则配置）
5. 小技能管理页面（含工资设置、批量编辑）
6. 员工-技能指派页面（含考核状态）

### 第二阶段：核算引擎
1. 绩效分导入（解析ERP Excel）
2. 在岗判断逻辑
3. 阶梯计算逻辑
4. 汇总计算
5. 结果导出Excel
6. 人工验证

### 第三阶段：历史记录
1. 历史数据存储
2. 月度归档
3. 历史查询页面

### 第四阶段：生产部署
1. 接入PostgreSQL
2. 部署到Mac Mini

---

*文档生成时间：2024年12月28日*
